function [f, g, H] = errinros(x)
%ERRINROS function
% S. Gratton, L. N. Vicente, Z. Zhang, 2019

lll = @(x) (sin(2:numel(x))');

f = (sum((x(1:end-1)- 16*x(2:end).^2.*lll(x)).^2 +(x(2:end)-1).^2));
g = ([2*(x(1:end-1)- 16*x(2:end).^2.*lll(x));0]...
        +[0;2*2*(-16)*lll(x).*(x(1:end-1)- 16*x(2:end).^2.*lll(x)).*x(2:end)+2*(x(2:end)-1)  ]) ;
H = (spdiags( ...
[[2*(-16)*2*x(2:end).*lll(x);0] ,[2*ones(numel(x(2:end)),1);0]+[0;2*2*(-16)*lll(x).*(...
(-16)*2*lll(x).*x(2:end).^2+(x(1:end-1)- 16*x(2:end).^2.*lll(x))...
)+2*ones(numel(x(2:end)),1) ]    , [0; 2*(-16)*2*x(2:end).*lll(x)  ]], ...
-1:1,length(x),length(x)));
